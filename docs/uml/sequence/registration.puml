@startuml
title Standard Face Registration

actor User
participant "Home\nScreen" as Home
participant "Preperation\nScreen" as Prep
participant "Scanning\nScreen" as Scan
participant "Enroll\nScreen" as Enroll
participant "Success\nScreen" as Success
participant "Camera" as Camera
participant "Face\nAnalyzer" as Analyzer
participant "MobileFaceNet" as FaceNet
participant "Room\nDB" as DB

User -> Home : Open application
Home -> Prep : Add your face

note right of Prep
Guidelines:
- Uncovered face
- Good lighting
end note

Prep -> Scan : Begin face scan
Scan -> Camera : Start capture

loop While scanning (Until 4 frames of the same person are captured with good quality)
Camera --> Scan : Frame
Scan -> Analyzer : Detect + quality + blink liveness
Analyzer --> Scan : Feedback state
end

Scan -> Camera : Stop capture
Scan -> FaceNet : Generate embedding (4 samples -> average)
FaceNet --> Scan : Pending embedding
Scan -> Enroll : Open full-name form

loop Until the user types a unique full name
User -> Enroll : Enter full name + Continue
Enroll -> DB : Check full name
DB --> Enroll : Conflict
Enroll --> User : Show "Name already in use"
end

DB --> Enroll : Available
Enroll -> DB : Save user(fullName, embedding)
DB --> Enroll : Saved
Enroll -> Success : Navigate to success
Success --> User : Show "You are all set {fullName}"
User -> Success : Tap Continue
Success -> Home : Continue

@enduml
