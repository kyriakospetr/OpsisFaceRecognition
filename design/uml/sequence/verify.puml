@startuml
title Face Verification (on-device)

actor User
participant "Home\nScreen" as Home
participant "Instructions\nScreen" as Prep
participant "Verify\nScreen" as Verify
participant "Camera" as Camera
participant "Face\nAnalyzer" as Analyzer
participant "Room\nDB" as DB

User -> Home : Opens application
Home -> Prep : Verify identity
Prep -> Verify : Start verification

Verify -> Camera : Start capture

loop While verifying (max 30s or until quality OK)
Camera --> Verify : Frame
Verify -> Analyzer : Detect + quality check
Analyzer --> Verify : OK / Not OK
end

Verify -> Camera : Stop capture

alt Face quality NOT OK
Verify --> User : Show verify failed (Return Home)
else Face quality OK
Verify -> Analyzer : Generate embedding
Analyzer --> Verify : Live face vector

Verify -> DB : Load enrolled template(s)
DB --> Verify : Stored face template(s)

Verify -> Analyzer : Compare(live, stored)
Analyzer --> Verify : Match / No match

alt Match
Verify --> User : Show verified (Return Home)
else No match
Verify --> User : Show verify failed (Return Home)
end
end
@enduml
