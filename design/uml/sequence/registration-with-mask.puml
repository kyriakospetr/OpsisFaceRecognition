@startuml
title Masked Face Registration

actor User
participant "Post-Register\nScreen" as Post
participant "Scanning\nScreen" as Scan
participant "Camera" as Camera
participant "Face\nAnalyzer" as Analyzer
participant "Room\nDB" as DB

User -> Post : Choose "Scan with Mask"
Post -> Scan : Open scanning (mask mode)

Scan -> Camera : Start capture

loop While scanning (max 30s or until quality OK)
Camera --> Scan : Frame
Scan -> Analyzer : Detect + quality check (mask)
Analyzer --> Scan : OK / Not OK
end

Scan -> Camera : Stop capture

alt Face quality NOT OK
Scan --> User : Show scan failed (Return Home)
else Face quality OK
Scan -> Analyzer : Generate embedding
Analyzer --> Scan : Face vector
Scan -> DB : Save masked template
DB --> Scan : Saved
Scan --> User : Show success options (Return Home)
end

@enduml

